external ( < ) : int -> int -> bool = "<";;
external ( - ) : int -> int -> int = "-";;
external ( + ) : int -> int -> int = "+";;

effect Get : unit -> int ;;
effect Put : int -> unit ;;

(let rec loop n =
  if 0 < n then #Put (#Get () + 1); loop (n - 1) else ()
in handle (loop 10) with
   | val x -> (fun s -> x)
   | #Get x k -> (fun s -> k s s)
   | #Put s k -> (fun t -> k () s)
) 0
